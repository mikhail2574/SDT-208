{% extends "base.html" %}

{% block content %}
<section class="panel">
    <header class="panel__header">
        <div>
            <p class="eyebrow">Question #{{ question.id }} Â· Test {{ test.id }}</p>
            <h1>{{ question.text }}</h1>
            <div class="meta-row">
                <span class="pill">Type: {{ question.type.replace("_", " ") }}</span>
                <span class="pill">Order: {{ question.order_index }}</span>
                <span class="pill">Points: {{ question.points }}</span>
            </div>
        </div>
        {% if can_manage %}
        <div class="stack">
            <a class="primary-btn" href="/questions/{{ question.id }}/edit">Edit question</a>
            <form method="post" action="/questions/{{ question.id }}/delete" onsubmit="return confirm('Delete this question?');">
                <button class="danger-btn" type="submit">Delete</button>
            </form>
        </div>
        {% endif %}
    </header>

    {% if question.type != 'free_text' %}
        {% if can_manage %}
        <div class="options-grid">
            <p class="eyebrow">Answer options</p>
            <ul class="options">
                {% for option in question.answer_options %}
                {% set opt_class = 'option-correct' if option.is_correct else 'option' %}
                <li class="{{ opt_class }}">
                    {{ option.text }}
                    {% if option.is_correct %}<span class="tag">Correct</span>{% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>
        {% else %}
            <p class="muted">Options hidden. Start the test to view choices.</p>
        {% endif %}
    {% else %}
    <p class="muted">This is a free text question (no predefined options).</p>
    {% endif %}

    <div class="form-actions">
        <a class="ghost-btn" href="/tests/{{ test.id }}">Back to test</a>
    </div>
</section>
{% endblock %}
